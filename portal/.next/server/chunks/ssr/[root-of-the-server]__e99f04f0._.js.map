{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/CaseActions.tsx"],"sourcesContent":["\"use client\";\nimport { useState } from \"react\";\n\ntype Props = {\n  caseId: string;\n  role: \"customer\" | \"lab\" | \"admin\";\n  currentStatus: string;\n};\n\nexport default function CaseActions({ caseId, role, currentStatus }: Props) {\n  const [note, setNote] = useState(\"\");\n\n  async function change(to: string) {\n    const r = await fetch(`/api/cases/${caseId}/transition`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ to, note }),\n    });\n    if (r.ok) window.location.reload();\n    else {\n      const j = await r.json().catch(() => ({}));\n      alert(j.error || \"Action failed\");\n    }\n  }\n\n  const canCustomer = new Set([\"APPROVED\", \"CHANGES_REQUESTED\"]);\n  const showApprove = role !== \"customer\" || canCustomer.has(\"APPROVED\");\n  const showRequest = role !== \"customer\" || canCustomer.has(\"CHANGES_REQUESTED\");\n\n  return (\n    <div className=\"space-y-3\">\n      <textarea\n        value={note}\n        onChange={(e) => setNote(e.target.value)}\n        placeholder=\"Add a short note (optional)\"\n        className=\"w-full h-20 rounded-lg p-2 bg-black/40 border border-white/10 text-white\"\n      />\n      <div className=\"flex gap-2\">\n        {showApprove && (\n          <button onClick={() => change(\"APPROVED\")} className=\"rounded-lg px-3 py-2 bg-white text-black\">\n            Approve\n          </button>\n        )}\n        {showRequest && (\n          <button onClick={() => change(\"CHANGES_REQUESTED\")} className=\"rounded-lg px-3 py-2 border border-white/20\">\n            Request changes\n          </button>\n        )}\n      </div>\n      <p className=\"text-xs text-white/50\">Current: {currentStatus}</p>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AADA;;;AASe,SAAS,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAS;IACxE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,eAAe,OAAO,EAAU;QAC9B,MAAM,IAAI,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,WAAW,CAAC,EAAE;YACvD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAI;YAAK;QAClC;QACA,IAAI,EAAE,EAAE,EAAE,OAAO,QAAQ,CAAC,MAAM;aAC3B;YACH,MAAM,IAAI,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YACxC,MAAM,EAAE,KAAK,IAAI;QACnB;IACF;IAEA,MAAM,cAAc,IAAI,IAAI;QAAC;QAAY;KAAoB;IAC7D,MAAM,cAAc,SAAS,cAAc,YAAY,GAAG,CAAC;IAC3D,MAAM,cAAc,SAAS,cAAc,YAAY,GAAG,CAAC;IAE3D,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gBACvC,aAAY;gBACZ,WAAU;;;;;;0BAEZ,8OAAC;gBAAI,WAAU;;oBACZ,6BACC,8OAAC;wBAAO,SAAS,IAAM,OAAO;wBAAa,WAAU;kCAA2C;;;;;;oBAIjG,6BACC,8OAAC;wBAAO,SAAS,IAAM,OAAO;wBAAsB,WAAU;kCAA8C;;;;;;;;;;;;0BAKhH,8OAAC;gBAAE,WAAU;;oBAAwB;oBAAU;;;;;;;;;;;;;AAGrD","debugId":null}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/FileUploader.tsx"],"sourcesContent":["// components/FileUploader.tsx\n\"use client\";\n\nimport { useState } from \"react\";\n\ntype Role = \"customer\" | \"lab\" | \"admin\";\n\nexport default function FileUploader({\n  caseId,\n  role,\n  slot, // \"scan\" | \"design_with_model\" | \"design_only\"\n}: {\n  caseId: string;\n  role: Role;\n  slot: \"scan\" | \"design_with_model\" | \"design_only\";\n}) {\n  const [busy, setBusy] = useState(false);\n  const [err, setErr] = useState<string | undefined>();\n  const [ok, setOk] = useState<string | undefined>();\n  const [file, setFile] = useState<File | null>(null);\n\n  if (role === \"customer\") return null;\n\n  const accept = slot === \"scan\" ? \".stl,.ply,.obj\" : \".stl\";\n\n  const labelText =\n    slot === \"scan\"\n      ? \"Upload scan (STL/PLY/OBJ)\"\n      : slot === \"design_with_model\"\n      ? \"Upload design + model (STL)\"\n      : \"Upload design only (STL)\";\n\n  function onFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const f = e.target.files?.[0] || null;\n    setFile(f);\n    setErr(undefined);\n    setOk(undefined);\n  }\n\n  async function send() {\n    if (!file) {\n      return setErr(\"Please choose a file first.\");\n    }\n\n    setBusy(true);\n    setErr(undefined);\n    setOk(undefined);\n\n    try {\n      const fd = new FormData();\n      fd.append(\"label\", slot);\n      fd.append(\"files\", file);\n\n      const r = await fetch(`/api/cases/${caseId}/files`, {\n        method: \"POST\",\n        body: fd,\n      });\n      const j = await r.json().catch(() => ({}));\n      if (!r.ok) {\n        throw new Error(j.error || \"Upload failed\");\n      }\n\n      setOk(\"Uploaded successfully.\");\n      // Reload to show the new model & file list\n      setTimeout(() => window.location.reload(), 600);\n    } catch (e: any) {\n      setErr(e?.message || \"Upload failed\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"text-sm text-white/70\">{labelText}</div>\n\n      <label className=\"flex items-center justify-between gap-3 rounded-lg p-3 bg-black/40 border border-white/10 cursor-pointer\">\n        <div className=\"flex-1 text-white/80\">\n          {file ? (\n            <>\n              <div className=\"font-medium truncate\">{file.name}</div>\n              <div className=\"text-xs text-white/60\">\n                {(file.size / (1024 * 1024)).toFixed(2)} MB\n              </div>\n            </>\n          ) : (\n            <div className=\"text-white/60\">Choose a file…</div>\n          )}\n        </div>\n        <div className=\"shrink-0 rounded-md bg-white text-black px-3 py-1.5 text-sm\">\n          Browse\n        </div>\n        <input\n          type=\"file\"\n          accept={accept}\n          onChange={onFileChange}\n          className=\"hidden\"\n        />\n      </label>\n\n      <div className=\"flex items-center gap-2\">\n        <button\n          onClick={send}\n          disabled={busy || !file}\n          className=\"rounded-lg px-3 py-1.5 bg-white text-black disabled:opacity-50\"\n        >\n          {busy ? \"Uploading…\" : \"Upload\"}\n        </button>\n        {ok && <span className=\"text-emerald-400 text-sm\">{ok}</span>}\n        {err && <span className=\"text-red-400 text-sm\">{err}</span>}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;;AAG9B;AAFA;;;AAMe,SAAS,aAAa,EACnC,MAAM,EACN,IAAI,EACJ,IAAI,EAKL;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ;IAC9B,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,iNAAQ;IAC5B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAE9C,IAAI,SAAS,YAAY,OAAO;IAEhC,MAAM,SAAS,SAAS,SAAS,mBAAmB;IAEpD,MAAM,YACJ,SAAS,SACL,8BACA,SAAS,sBACT,gCACA;IAEN,SAAS,aAAa,CAAsC;QAC1D,MAAM,IAAI,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI;QACjC,QAAQ;QACR,OAAO;QACP,MAAM;IACR;IAEA,eAAe;QACb,IAAI,CAAC,MAAM;YACT,OAAO,OAAO;QAChB;QAEA,QAAQ;QACR,OAAO;QACP,MAAM;QAEN,IAAI;YACF,MAAM,KAAK,IAAI;YACf,GAAG,MAAM,CAAC,SAAS;YACnB,GAAG,MAAM,CAAC,SAAS;YAEnB,MAAM,IAAI,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,MAAM,CAAC,EAAE;gBAClD,QAAQ;gBACR,MAAM;YACR;YACA,MAAM,IAAI,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,EAAE,EAAE,EAAE;gBACT,MAAM,IAAI,MAAM,EAAE,KAAK,IAAI;YAC7B;YAEA,MAAM;YACN,2CAA2C;YAC3C,WAAW,IAAM,OAAO,QAAQ,CAAC,MAAM,IAAI;QAC7C,EAAE,OAAO,GAAQ;YACf,OAAO,GAAG,WAAW;QACvB,SAAU;YACR,QAAQ;QACV;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BAAyB;;;;;;0BAExC,8OAAC;gBAAM,WAAU;;kCACf,8OAAC;wBAAI,WAAU;kCACZ,qBACC;;8CACE,8OAAC;oCAAI,WAAU;8CAAwB,KAAK,IAAI;;;;;;8CAChD,8OAAC;oCAAI,WAAU;;wCACZ,CAAC,KAAK,IAAI,GAAG,CAAC,OAAO,IAAI,CAAC,EAAE,OAAO,CAAC;wCAAG;;;;;;;;yDAI5C,8OAAC;4BAAI,WAAU;sCAAgB;;;;;;;;;;;kCAGnC,8OAAC;wBAAI,WAAU;kCAA8D;;;;;;kCAG7E,8OAAC;wBACC,MAAK;wBACL,QAAQ;wBACR,UAAU;wBACV,WAAU;;;;;;;;;;;;0BAId,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,UAAU,QAAQ,CAAC;wBACnB,WAAU;kCAET,OAAO,eAAe;;;;;;oBAExB,oBAAM,8OAAC;wBAAK,WAAU;kCAA4B;;;;;;oBAClD,qBAAO,8OAAC;wBAAK,WAAU;kCAAwB;;;;;;;;;;;;;;;;;;AAIxD","debugId":null}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/Case3DPanel.tsx"],"sourcesContent":["'use client';\n\nimport dynamic from 'next/dynamic';\nimport { useMemo } from 'react';\n\nconst STLViewer = dynamic(() => import('@/components/STLViewer'), { ssr: false });\n\nexport default function Case3DPanel({\n  url,\n  title,\n}: {\n  url?: string | null;\n  title?: string;\n}) {\n  const hasModel = !!url;\n  const source = useMemo(() => url ?? '', [url]);\n\n  return (\n    <div className=\"rounded-xl border border-white/10 p-4\">\n      <div className=\"flex items-center justify-between mb-3\">\n        <h2 className=\"font-medium\">{title ?? '3D View'}</h2>\n      </div>\n\n      {!hasModel ? (\n        <p className=\"text-white/60\">No STL available.</p>\n      ) : (\n        <div className=\"h-80 rounded-lg overflow-hidden bg-black/30\">\n          {/* STLViewer is client-only; safe here */}\n          <STLViewer url={source} />\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;AAHA;;;;AAKA,MAAM,YAAY,IAAA,0KAAO;;;;;;IAA2C,KAAK;;AAE1D,SAAS,YAAY,EAClC,GAAG,EACH,KAAK,EAIN;IACC,MAAM,WAAW,CAAC,CAAC;IACnB,MAAM,SAAS,IAAA,gNAAO,EAAC,IAAM,OAAO,IAAI;QAAC;KAAI;IAE7C,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAG,WAAU;8BAAe,SAAS;;;;;;;;;;;YAGvC,CAAC,yBACA,8OAAC;gBAAE,WAAU;0BAAgB;;;;;qCAE7B,8OAAC;gBAAI,WAAU;0BAEb,cAAA,8OAAC;oBAAU,KAAK;;;;;;;;;;;;;;;;;AAK1B","debugId":null}}]
}