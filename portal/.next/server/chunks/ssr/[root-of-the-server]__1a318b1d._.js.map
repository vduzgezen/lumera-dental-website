{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/CaseActions.tsx"],"sourcesContent":["\"use client\";\nimport { useState } from \"react\";\n\ntype Props = {\n  caseId: string;\n  role: \"customer\" | \"lab\" | \"admin\";\n  currentStatus: string;\n};\n\nexport default function CaseActions({ caseId, role, currentStatus }: Props) {\n  const [note, setNote] = useState(\"\");\n\n  async function change(to: string) {\n    const r = await fetch(`/api/cases/${caseId}/transition`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ to, note }),\n    });\n    if (r.ok) window.location.reload();\n    else {\n      const j = await r.json().catch(() => ({}));\n      alert(j.error || \"Action failed\");\n    }\n  }\n\n  const canCustomer = new Set([\"APPROVED\", \"CHANGES_REQUESTED\"]);\n  const showApprove = role !== \"customer\" || canCustomer.has(\"APPROVED\");\n  const showRequest = role !== \"customer\" || canCustomer.has(\"CHANGES_REQUESTED\");\n\n  return (\n    <div className=\"space-y-3\">\n      <textarea\n        value={note}\n        onChange={(e) => setNote(e.target.value)}\n        placeholder=\"Add a short note (optional)\"\n        className=\"w-full h-20 rounded-lg p-2 bg-black/40 border border-white/10 text-white\"\n      />\n      <div className=\"flex gap-2\">\n        {showApprove && (\n          <button onClick={() => change(\"APPROVED\")} className=\"rounded-lg px-3 py-2 bg-white text-black\">\n            Approve\n          </button>\n        )}\n        {showRequest && (\n          <button onClick={() => change(\"CHANGES_REQUESTED\")} className=\"rounded-lg px-3 py-2 border border-white/20\">\n            Request changes\n          </button>\n        )}\n      </div>\n      <p className=\"text-xs text-white/50\">Current: {currentStatus}</p>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AADA;;;AASe,SAAS,YAAY,EAAE,MAAM,EAAE,IAAI,EAAE,aAAa,EAAS;IACxE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,eAAe,OAAO,EAAU;QAC9B,MAAM,IAAI,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,WAAW,CAAC,EAAE;YACvD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAI;YAAK;QAClC;QACA,IAAI,EAAE,EAAE,EAAE,OAAO,QAAQ,CAAC,MAAM;aAC3B;YACH,MAAM,IAAI,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YACxC,MAAM,EAAE,KAAK,IAAI;QACnB;IACF;IAEA,MAAM,cAAc,IAAI,IAAI;QAAC;QAAY;KAAoB;IAC7D,MAAM,cAAc,SAAS,cAAc,YAAY,GAAG,CAAC;IAC3D,MAAM,cAAc,SAAS,cAAc,YAAY,GAAG,CAAC;IAE3D,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,OAAO;gBACP,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;gBACvC,aAAY;gBACZ,WAAU;;;;;;0BAEZ,8OAAC;gBAAI,WAAU;;oBACZ,6BACC,8OAAC;wBAAO,SAAS,IAAM,OAAO;wBAAa,WAAU;kCAA2C;;;;;;oBAIjG,6BACC,8OAAC;wBAAO,SAAS,IAAM,OAAO;wBAAsB,WAAU;kCAA8C;;;;;;;;;;;;0BAKhH,8OAAC;gBAAE,WAAU;;oBAAwB;oBAAU;;;;;;;;;;;;;AAGrD","debugId":null}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/FileUploader.tsx"],"sourcesContent":["// components/FileUploader.tsx\n\"use client\";\n\nimport { useState } from \"react\";\n\ntype Role = \"customer\" | \"lab\" | \"admin\";\n\nexport default function FileUploader({\n  caseId,\n  role,\n  slot, // \"scan\" | \"design_with_model\" | \"design_only\"\n}: {\n  caseId: string;\n  role: Role;\n  slot: \"scan\" | \"design_with_model\" | \"design_only\";\n}) {\n  const [busy, setBusy] = useState(false);\n  const [err, setErr] = useState<string | undefined>();\n  const [ok, setOk] = useState<string | undefined>();\n  const [file, setFile] = useState<File | null>(null);\n\n  if (role === \"customer\") return null;\n\n  const accept = slot === \"scan\" ? \".stl,.ply,.obj\" : \".stl\";\n\n  const labelText =\n    slot === \"scan\"\n      ? \"Upload scan (STL/PLY/OBJ)\"\n      : slot === \"design_with_model\"\n      ? \"Upload design + model (STL/PLY/OBJ)\"\n      : \"Upload design only (STL/PLY/OBJ)\";\n\n  function onFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const f = e.target.files?.[0] || null;\n    setFile(f);\n    setErr(undefined);\n    setOk(undefined);\n  }\n\n  async function send() {\n    if (!file) {\n      return setErr(\"Please choose a file first.\");\n    }\n\n    setBusy(true);\n    setErr(undefined);\n    setOk(undefined);\n\n    try {\n      const fd = new FormData();\n      fd.append(\"label\", slot);\n      fd.append(\"files\", file);\n\n      const r = await fetch(`/api/cases/${caseId}/files`, {\n        method: \"POST\",\n        body: fd,\n      });\n      const j = await r.json().catch(() => ({}));\n      if (!r.ok) {\n        throw new Error(j.error || \"Upload failed\");\n      }\n\n      setOk(\"Uploaded successfully.\");\n      setTimeout(() => window.location.reload(), 600);\n    } catch (e: any) {\n      setErr(e?.message || \"Upload failed\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"text-xs text-white/60\">{labelText}</div>\n\n      <label className=\"flex items-center justify-between gap-3 rounded-lg p-2 bg-black/40 border border-white/10 cursor-pointer\">\n        <div className=\"flex-1 min-w-0 text-white/80\">\n          {file ? (\n            <>\n              <div className=\"font-medium text-xs truncate\" title={file.name}>\n                {file.name}\n              </div>\n              <div className=\"text-[10px] text-white/60\">\n                {(file.size / (1024 * 1024)).toFixed(2)} MB\n              </div>\n            </>\n          ) : (\n            <div className=\"text-xs text.white/60 truncate\">\n              Choose a fileâ€¦\n            </div>\n          )}\n        </div>\n        <div className=\"shrink-0 rounded-md bg-white text-black px-3 py-1.5 text-xs\">\n          Browse\n        </div>\n        <input\n          type=\"file\"\n          accept={accept}\n          onChange={onFileChange}\n          className=\"hidden\"\n        />\n      </label>\n\n      <div className=\"flex items-center gap-2\">\n        <button\n          onClick={send}\n          disabled={busy || !file}\n          className=\"rounded-lg px-3 py-1.5 bg-white text-black text-xs disabled:opacity-50\"\n        >\n          {busy ? \"Uploadingâ€¦\" : \"Upload\"}\n        </button>\n        {ok && <span className=\"text-emerald-400 text-xs\">{ok}</span>}\n        {err && <span className=\"text-red-400 text-xs\">{err}</span>}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;;AAG9B;AAFA;;;AAMe,SAAS,aAAa,EACnC,MAAM,EACN,IAAI,EACJ,IAAI,EAKL;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ;IAC9B,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,iNAAQ;IAC5B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAE9C,IAAI,SAAS,YAAY,OAAO;IAEhC,MAAM,SAAS,SAAS,SAAS,mBAAmB;IAEpD,MAAM,YACJ,SAAS,SACL,8BACA,SAAS,sBACT,wCACA;IAEN,SAAS,aAAa,CAAsC;QAC1D,MAAM,IAAI,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI;QACjC,QAAQ;QACR,OAAO;QACP,MAAM;IACR;IAEA,eAAe;QACb,IAAI,CAAC,MAAM;YACT,OAAO,OAAO;QAChB;QAEA,QAAQ;QACR,OAAO;QACP,MAAM;QAEN,IAAI;YACF,MAAM,KAAK,IAAI;YACf,GAAG,MAAM,CAAC,SAAS;YACnB,GAAG,MAAM,CAAC,SAAS;YAEnB,MAAM,IAAI,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,MAAM,CAAC,EAAE;gBAClD,QAAQ;gBACR,MAAM;YACR;YACA,MAAM,IAAI,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,EAAE,EAAE,EAAE;gBACT,MAAM,IAAI,MAAM,EAAE,KAAK,IAAI;YAC7B;YAEA,MAAM;YACN,WAAW,IAAM,OAAO,QAAQ,CAAC,MAAM,IAAI;QAC7C,EAAE,OAAO,GAAQ;YACf,OAAO,GAAG,WAAW;QACvB,SAAU;YACR,QAAQ;QACV;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BAAyB;;;;;;0BAExC,8OAAC;gBAAM,WAAU;;kCACf,8OAAC;wBAAI,WAAU;kCACZ,qBACC;;8CACE,8OAAC;oCAAI,WAAU;oCAA+B,OAAO,KAAK,IAAI;8CAC3D,KAAK,IAAI;;;;;;8CAEZ,8OAAC;oCAAI,WAAU;;wCACZ,CAAC,KAAK,IAAI,GAAG,CAAC,OAAO,IAAI,CAAC,EAAE,OAAO,CAAC;wCAAG;;;;;;;;yDAI5C,8OAAC;4BAAI,WAAU;sCAAiC;;;;;;;;;;;kCAKpD,8OAAC;wBAAI,WAAU;kCAA8D;;;;;;kCAG7E,8OAAC;wBACC,MAAK;wBACL,QAAQ;wBACR,UAAU;wBACV,WAAU;;;;;;;;;;;;0BAId,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,UAAU,QAAQ,CAAC;wBACnB,WAAU;kCAET,OAAO,eAAe;;;;;;oBAExB,oBAAM,8OAAC;wBAAK,WAAU;kCAA4B;;;;;;oBAClD,qBAAO,8OAAC;wBAAK,WAAU;kCAAwB;;;;;;;;;;;;;;;;;;AAIxD","debugId":null}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/CaseProcessBar.tsx"],"sourcesContent":["// components/CaseProcessBar.tsx\n\"use client\";\n\nimport { useState } from \"react\";\n\ntype Stage = \"DESIGN\" | \"MILLING_GLAZING\" | \"SHIPPING\";\ntype Role = \"admin\" | \"lab\" | \"customer\";\n\nconst STAGE_ORDER: Stage[] = [\"DESIGN\", \"MILLING_GLAZING\", \"SHIPPING\"];\n\nconst STAGE_LABEL: Record<Stage, string> = {\n  DESIGN: \"Designing\",\n  MILLING_GLAZING: \"Milling & Glazing\",\n  SHIPPING: \"Delivering\",\n};\n\nconst STAGE_HELP: Record<Stage, string> = {\n  DESIGN: \"Case is in design (scans, adjustments, approvals).\",\n  MILLING_GLAZING: \"Case is being milled and glazed.\",\n  SHIPPING: \"Case is packaged and being delivered.\",\n};\n\nexport default function CaseProcessBar({\n  caseId,\n  stage: initialStage,\n  role,\n}: {\n  caseId: string;\n  stage: Stage;\n  role: Role;\n}) {\n  const [stage, setStage] = useState<Stage>(initialStage);\n  const [busy, setBusy] = useState(false);\n  const [err, setErr] = useState<string | null>(null);\n\n  const currentIndex = STAGE_ORDER.indexOf(stage);\n  const canEdit = role === \"admin\" || role === \"lab\";\n\n  async function changeStage(next: Stage) {\n    if (!canEdit) return;\n    const nextIndex = STAGE_ORDER.indexOf(next);\n    if (nextIndex <= currentIndex) return; // only forward\n\n    setBusy(true);\n    setErr(null);\n    try {\n      const res = await fetch(`/api/cases/${caseId}/stage`, {\n        method: \"PATCH\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ stage: next }),\n      });\n      const data = await res.json().catch(() => ({}));\n      if (!res.ok) {\n        throw new Error(data.error || \"Failed to update stage\");\n      }\n      setStage(next);\n    } catch (e: any) {\n      setErr(e?.message || \"Failed to update stage\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"mb-4\">\n      <div className=\"mb-2 flex items-center justify-between\">\n        <div>\n          <h2 className=\"text-sm font-semibold text-white/90\">\n            Manufacturing Process\n          </h2>\n          <p className=\"text-xs text-white/60\">\n            {STAGE_HELP[stage]}\n          </p>\n        </div>\n        {busy && (\n          <span className=\"text-xs text-white/60\">Updatingâ€¦</span>\n        )}\n      </div>\n\n      <div className=\"relative flex items-center\">\n        {/* Line */}\n        <div className=\"absolute left-4 right-4 h-px bg-white/10 top-1/2 -translate-y-1/2\" />\n\n        {/* Steps */}\n        <ol className=\"relative z-10 flex w-full justify-between\">\n          {STAGE_ORDER.map((s, idx) => {\n            const isActive = idx === currentIndex;\n            const isDone = idx < currentIndex;\n            const clickable =\n              canEdit && idx > currentIndex && !busy;\n\n            return (\n              <li key={s} className=\"flex flex-col items-center w-1/3\">\n                <button\n                  type=\"button\"\n                  disabled={!clickable}\n                  onClick={() => clickable && changeStage(s)}\n                  className={[\n                    \"w-7 h-7 rounded-full border flex items-center justify-center text-xs\",\n                    isDone\n                      ? \"bg-emerald-400 border-emerald-300 text-black\"\n                      : isActive\n                      ? \"bg-white text-black border-white\"\n                      : \"bg-black border-white/30 text-white/60\",\n                    clickable ? \"hover:scale-105 transition-transform\" : \"\",\n                  ].join(\" \")}\n                >\n                  {isDone ? \"âœ“\" : idx + 1}\n                </button>\n                <span className=\"mt-1 text-[11px] text-center text-white/70\">\n                  {STAGE_LABEL[s]}\n                </span>\n              </li>\n            );\n          })}\n        </ol>\n      </div>\n\n      {err && (\n        <p className=\"mt-2 text-xs text-red-400\">\n          {err}\n        </p>\n      )}\n\n      {!canEdit && (\n        <p className=\"mt-1 text-[11px] text-white/50\">\n          This timeline is managed by the lab.\n        </p>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;;;AAGhC;AAFA;;;AAOA,MAAM,cAAuB;IAAC;IAAU;IAAmB;CAAW;AAEtE,MAAM,cAAqC;IACzC,QAAQ;IACR,iBAAiB;IACjB,UAAU;AACZ;AAEA,MAAM,aAAoC;IACxC,QAAQ;IACR,iBAAiB;IACjB,UAAU;AACZ;AAEe,SAAS,eAAe,EACrC,MAAM,EACN,OAAO,YAAY,EACnB,IAAI,EAKL;IACC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAQ;IAC1C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAgB;IAE9C,MAAM,eAAe,YAAY,OAAO,CAAC;IACzC,MAAM,UAAU,SAAS,WAAW,SAAS;IAE7C,eAAe,YAAY,IAAW;QACpC,IAAI,CAAC,SAAS;QACd,MAAM,YAAY,YAAY,OAAO,CAAC;QACtC,IAAI,aAAa,cAAc,QAAQ,eAAe;QAEtD,QAAQ;QACR,OAAO;QACP,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,MAAM,CAAC,EAAE;gBACpD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,OAAO;gBAAK;YACrC;YACA,MAAM,OAAO,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,MAAM,IAAI,MAAM,KAAK,KAAK,IAAI;YAChC;YACA,SAAS;QACX,EAAE,OAAO,GAAQ;YACf,OAAO,GAAG,WAAW;QACvB,SAAU;YACR,QAAQ;QACV;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAsC;;;;;;0CAGpD,8OAAC;gCAAE,WAAU;0CACV,UAAU,CAAC,MAAM;;;;;;;;;;;;oBAGrB,sBACC,8OAAC;wBAAK,WAAU;kCAAwB;;;;;;;;;;;;0BAI5C,8OAAC;gBAAI,WAAU;;kCAEb,8OAAC;wBAAI,WAAU;;;;;;kCAGf,8OAAC;wBAAG,WAAU;kCACX,YAAY,GAAG,CAAC,CAAC,GAAG;4BACnB,MAAM,WAAW,QAAQ;4BACzB,MAAM,SAAS,MAAM;4BACrB,MAAM,YACJ,WAAW,MAAM,gBAAgB,CAAC;4BAEpC,qBACE,8OAAC;gCAAW,WAAU;;kDACpB,8OAAC;wCACC,MAAK;wCACL,UAAU,CAAC;wCACX,SAAS,IAAM,aAAa,YAAY;wCACxC,WAAW;4CACT;4CACA,SACI,iDACA,WACA,qCACA;4CACJ,YAAY,yCAAyC;yCACtD,CAAC,IAAI,CAAC;kDAEN,SAAS,MAAM,MAAM;;;;;;kDAExB,8OAAC;wCAAK,WAAU;kDACb,WAAW,CAAC,EAAE;;;;;;;+BAlBV;;;;;wBAsBb;;;;;;;;;;;;YAIH,qBACC,8OAAC;gBAAE,WAAU;0BACV;;;;;;YAIJ,CAAC,yBACA,8OAAC;gBAAE,WAAU;0BAAiC;;;;;;;;;;;;AAMtD","debugId":null}},
    {"offset": {"line": 486, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/HtmlViewerUploader.tsx"],"sourcesContent":["// components/HtmlViewerUploader.tsx\n\"use client\";\n\nimport { useState } from \"react\";\n\ntype Role = \"customer\" | \"lab\" | \"admin\";\n\nexport default function HtmlViewerUploader({\n  caseId,\n  role,\n  label,\n  description,\n}: {\n  caseId: string;\n  role: Role;\n  label: \"scan_html\" | \"design_with_model_html\";\n  description: string;\n}) {\n  const [busy, setBusy] = useState(false);\n  const [err, setErr] = useState<string | undefined>();\n  const [ok, setOk] = useState<string | undefined>();\n  const [file, setFile] = useState<File | null>(null);\n\n  if (role === \"customer\") return null;\n\n  function onFileChange(e: React.ChangeEvent<HTMLInputElement>) {\n    const f = e.target.files?.[0] || null;\n    setFile(f);\n    setErr(undefined);\n    setOk(undefined);\n  }\n\n  async function send() {\n    if (!file) {\n      return setErr(\"Please choose a file first.\");\n    }\n\n    setBusy(true);\n    setErr(undefined);\n    setOk(undefined);\n\n    try {\n      const fd = new FormData();\n      fd.append(\"label\", label);\n      fd.append(\"file\", file);\n\n      const r = await fetch(`/api/cases/${caseId}/files`, {\n        method: \"POST\",\n        body: fd,\n      });\n      const j = await r.json().catch(() => ({}));\n      if (!r.ok) {\n        throw new Error(j.error || \"Upload failed\");\n      }\n\n      setOk(\"Viewer uploaded.\");\n      setTimeout(() => window.location.reload(), 600);\n    } catch (e: any) {\n      setErr(e?.message || \"Upload failed\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"text-xs text-white/60\">{description}</div>\n\n      <label className=\"flex items-center justify-between gap-3 rounded-lg p-2 bg-black/40 border border-white/10 cursor-pointer\">\n        <div className=\"flex-1 min-w-0 text-white/80\">\n          {file ? (\n            <>\n              <div className=\"font-medium text-xs truncate\" title={file.name}>\n                {file.name}\n              </div>\n              <div className=\"text-[10px] text-white/60\">\n                {(file.size / (1024 * 1024)).toFixed(2)} MB\n              </div>\n            </>\n          ) : (\n            <div className=\"text-xs text-white/60 truncate\">\n              Choose Exocad HTMLâ€¦\n            </div>\n          )}\n        </div>\n        <div className=\"shrink-0 rounded-md bg-white text-black px-3 py-1.5 text-xs\">\n          Browse\n        </div>\n        <input\n          type=\"file\"\n          accept=\".html,text/html\"\n          onChange={onFileChange}\n          className=\"hidden\"\n        />\n      </label>\n\n      <div className=\"flex items-center gap-2\">\n        <button\n          onClick={send}\n          disabled={busy || !file}\n          className=\"rounded-lg px-3 py-1.5 bg-white text-black text-xs disabled:opacity-50\"\n        >\n          {busy ? \"Uploadingâ€¦\" : \"Upload viewer\"}\n        </button>\n        {ok && <span className=\"text-emerald-400 text-xs\">{ok}</span>}\n        {err && <span className=\"text-red-400 text-xs\">{err}</span>}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,oCAAoC;;;;;;AAGpC;AAFA;;;AAMe,SAAS,mBAAmB,EACzC,MAAM,EACN,IAAI,EACJ,KAAK,EACL,WAAW,EAMZ;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ;IAC9B,MAAM,CAAC,IAAI,MAAM,GAAG,IAAA,iNAAQ;IAC5B,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAE9C,IAAI,SAAS,YAAY,OAAO;IAEhC,SAAS,aAAa,CAAsC;QAC1D,MAAM,IAAI,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI;QACjC,QAAQ;QACR,OAAO;QACP,MAAM;IACR;IAEA,eAAe;QACb,IAAI,CAAC,MAAM;YACT,OAAO,OAAO;QAChB;QAEA,QAAQ;QACR,OAAO;QACP,MAAM;QAEN,IAAI;YACF,MAAM,KAAK,IAAI;YACf,GAAG,MAAM,CAAC,SAAS;YACnB,GAAG,MAAM,CAAC,QAAQ;YAElB,MAAM,IAAI,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,MAAM,CAAC,EAAE;gBAClD,QAAQ;gBACR,MAAM;YACR;YACA,MAAM,IAAI,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,EAAE,EAAE,EAAE;gBACT,MAAM,IAAI,MAAM,EAAE,KAAK,IAAI;YAC7B;YAEA,MAAM;YACN,WAAW,IAAM,OAAO,QAAQ,CAAC,MAAM,IAAI;QAC7C,EAAE,OAAO,GAAQ;YACf,OAAO,GAAG,WAAW;QACvB,SAAU;YACR,QAAQ;QACV;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;0BAAyB;;;;;;0BAExC,8OAAC;gBAAM,WAAU;;kCACf,8OAAC;wBAAI,WAAU;kCACZ,qBACC;;8CACE,8OAAC;oCAAI,WAAU;oCAA+B,OAAO,KAAK,IAAI;8CAC3D,KAAK,IAAI;;;;;;8CAEZ,8OAAC;oCAAI,WAAU;;wCACZ,CAAC,KAAK,IAAI,GAAG,CAAC,OAAO,IAAI,CAAC,EAAE,OAAO,CAAC;wCAAG;;;;;;;;yDAI5C,8OAAC;4BAAI,WAAU;sCAAiC;;;;;;;;;;;kCAKpD,8OAAC;wBAAI,WAAU;kCAA8D;;;;;;kCAG7E,8OAAC;wBACC,MAAK;wBACL,QAAO;wBACP,UAAU;wBACV,WAAU;;;;;;;;;;;;0BAId,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,UAAU,QAAQ,CAAC;wBACnB,WAAU;kCAET,OAAO,eAAe;;;;;;oBAExB,oBAAM,8OAAC;wBAAK,WAAU;kCAA4B;;;;;;oBAClD,qBAAO,8OAAC;wBAAK,WAAU;kCAAwB;;;;;;;;;;;;;;;;;;AAIxD","debugId":null}},
    {"offset": {"line": 657, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/Case3DPanel.tsx"],"sourcesContent":["// components/Case3DPanel.tsx\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { useMemo } from \"react\";\n\nconst STLViewer = dynamic(() => import(\"@/components/STLViewer\"), {\n  ssr: false,\n});\n\nexport default function Case3DPanel({\n  url,\n  title,\n}: {\n  url?: string | null;\n  title?: string;\n}) {\n  const hasModel = !!url;\n  const source = useMemo(() => url ?? \"\", [url]);\n\n  return (\n    <div className=\"rounded-xl border border-white/10 p-4 h-full flex flex-col\">\n      {title && (\n        <div className=\"flex items-center justify-between mb-3\">\n          <h2 className=\"font-medium\">{title}</h2>\n        </div>\n      )}\n\n      {!hasModel ? (\n        <p className=\"text-white/60 text-sm\">\n          No 3D file available for this slot.\n        </p>\n      ) : (\n        <div className=\"flex-1 h-80 rounded-lg overflow-hidden bg-black/30\">\n          {/* STLViewer is client-only; safe here */}\n          <STLViewer url={source} />\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;AAG7B;AACA;;AAHA;;;;AAKA,MAAM,YAAY,IAAA,0KAAO;;;;;;IACvB,KAAK;;AAGQ,SAAS,YAAY,EAClC,GAAG,EACH,KAAK,EAIN;IACC,MAAM,WAAW,CAAC,CAAC;IACnB,MAAM,SAAS,IAAA,gNAAO,EAAC,IAAM,OAAO,IAAI;QAAC;KAAI;IAE7C,qBACE,8OAAC;QAAI,WAAU;;YACZ,uBACC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAG,WAAU;8BAAe;;;;;;;;;;;YAIhC,CAAC,yBACA,8OAAC;gBAAE,WAAU;0BAAwB;;;;;qCAIrC,8OAAC;gBAAI,WAAU;0BAEb,cAAA,8OAAC;oBAAU,KAAK;;;;;;;;;;;;;;;;;AAK1B","debugId":null}},
    {"offset": {"line": 733, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/CaseViewerTabs.tsx"],"sourcesContent":["// portal/components/CaseViewerTabs.tsx\n\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport Case3DPanel from \"@/components/Case3DPanel\";\n\ntype TabKey = \"scan\" | \"design_with_model\" | \"design_only\";\n\nexport default function CaseViewerTabs({\n  scan3DUrl,\n  designWithModel3DUrl,\n  designOnly3DUrl,\n  scanHtmlUrl,\n  designHtmlUrl,\n}: {\n  scan3DUrl: string | null;\n  designWithModel3DUrl: string | null;\n  designOnly3DUrl: string | null;\n  scanHtmlUrl: string | null;\n  designHtmlUrl: string | null;\n}) {\n  const [tab, setTab] = useState<TabKey>(\"scan\");\n\n  const hasScanViewer = !!scanHtmlUrl || !!scan3DUrl;\n  const hasDesignViewer = !!designHtmlUrl || !!designWithModel3DUrl;\n  const hasDesignOnlyViewer = !!designOnly3DUrl;\n\n  // ðŸ” Remember last selected tab across refreshes/uploads\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n\n    const STORAGE_KEY = \"lumera.caseViewerTab\";\n    const stored = window.localStorage.getItem(STORAGE_KEY) as TabKey | null;\n\n    const available: Record<TabKey, boolean> = {\n      scan: hasScanViewer,\n      design_with_model: hasDesignViewer,\n      design_only: hasDesignOnlyViewer,\n    };\n\n    const order: TabKey[] = [\"scan\", \"design_with_model\", \"design_only\"];\n\n    // If we have a stored tab and it's still valid for this case, use it.\n    if (stored && available[stored]) {\n      if (stored !== tab) {\n        setTab(stored);\n      }\n      return;\n    }\n\n    // If current tab is valid, keep it.\n    if (available[tab]) return;\n\n    // Otherwise, pick the first available tab in priority order.\n    for (const key of order) {\n      if (available[key]) {\n        setTab(key);\n        window.localStorage.setItem(STORAGE_KEY, key);\n        return;\n      }\n    }\n    // If no viewers at all, leave default \"scan\".\n  }, [hasScanViewer, hasDesignViewer, hasDesignOnlyViewer, tab]);\n\n  function selectTab(key: TabKey) {\n    const available: Record<TabKey, boolean> = {\n      scan: hasScanViewer,\n      design_with_model: hasDesignViewer,\n      design_only: hasDesignOnlyViewer,\n    };\n    if (!available[key]) return;\n\n    setTab(key);\n    if (typeof window !== \"undefined\") {\n      window.localStorage.setItem(\"lumera.caseViewerTab\", key);\n    }\n  }\n\n  function renderContent() {\n    if (tab === \"scan\") {\n      if (scanHtmlUrl) {\n        return (\n          <div className=\"rounded-xl border border-white/10 p-4 h-full flex flex-col\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <h2 className=\"font-medium\">Scan Viewer (Exocad)</h2>\n            </div>\n            <div className=\"flex-1 h-80 rounded-lg overflow-hidden bg-black/30\">\n              <iframe src={scanHtmlUrl} className=\"w-full h-full border-0\" />\n            </div>\n          </div>\n        );\n      }\n      if (scan3DUrl) {\n        return <Case3DPanel url={scan3DUrl} />;\n      }\n      return (\n        <div className=\"rounded-xl border border-white/10 p-4 h-full flex items-center justify-center text-sm text-white/60\">\n          No scan viewer or 3D file available.\n        </div>\n      );\n    }\n\n    if (tab === \"design_with_model\") {\n      if (designHtmlUrl) {\n        return (\n          <div className=\"rounded-xl border border-white/10 p-4 h-full flex flex-col\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <h2 className=\"font-medium\">Design + Model Viewer (Exocad)</h2>\n            </div>\n            <div className=\"flex-1 h-80 rounded-lg overflow-hidden bg-black/30\">\n              <iframe src={designHtmlUrl} className=\"w-full h-full border-0\" />\n            </div>\n          </div>\n        );\n      }\n      if (designWithModel3DUrl) {\n        return <Case3DPanel url={designWithModel3DUrl} />;\n      }\n      return (\n        <div className=\"rounded-xl border border-white/10 p-4 h-full flex items-center justify-center text-sm text-white/60\">\n          No design + model viewer or 3D file available.\n        </div>\n      );\n    }\n\n    // design_only\n    if (designOnly3DUrl) {\n      return <Case3DPanel url={designOnly3DUrl} />;\n    }\n    return (\n      <div className=\"rounded-xl border border-white/10 p-4 h-full flex items-center justify-center text-sm text-white/60\">\n        No design-only 3D file available.\n      </div>\n    );\n  }\n\n  const tabClass = (key: TabKey, enabled: boolean) =>\n    [\n      \"px-3 py-1.5 text-xs sm:text-sm rounded-full\",\n      enabled\n        ? tab === key\n          ? \"bg-white text-black\"\n          : \"text-white/80 hover:bg-white/10\"\n        : \"text-white/30 cursor-not-allowed\",\n    ].join(\" \");\n\n  return (\n    <div className=\"h-full flex flex-col gap-3\">\n      <div className=\"inline-flex rounded-full bg-black/40 border border-white/10 p-1 self-start\">\n        <button\n          type=\"button\"\n          className={tabClass(\"scan\", hasScanViewer)}\n          onClick={() => selectTab(\"scan\")}\n          disabled={!hasScanViewer}\n        >\n          Scan\n        </button>\n        <button\n          type=\"button\"\n          className={tabClass(\"design_with_model\", hasDesignViewer)}\n          onClick={() => selectTab(\"design_with_model\")}\n          disabled={!hasDesignViewer}\n        >\n          Design + Model\n        </button>\n        <button\n          type=\"button\"\n          className={tabClass(\"design_only\", hasDesignOnlyViewer)}\n          onClick={() => selectTab(\"design_only\")}\n          disabled={!hasDesignOnlyViewer}\n        >\n          Design Only\n        </button>\n      </div>\n\n      <div className=\"flex-1 min-h-[18rem]\">{renderContent()}</div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,uCAAuC;;;;;;AAGvC;AACA;AAHA;;;;AAOe,SAAS,eAAe,EACrC,SAAS,EACT,oBAAoB,EACpB,eAAe,EACf,WAAW,EACX,aAAa,EAOd;IACC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAS;IAEvC,MAAM,gBAAgB,CAAC,CAAC,eAAe,CAAC,CAAC;IACzC,MAAM,kBAAkB,CAAC,CAAC,iBAAiB,CAAC,CAAC;IAC7C,MAAM,sBAAsB,CAAC,CAAC;IAE9B,yDAAyD;IACzD,IAAA,kNAAS,EAAC;QACR,wCAAmC;;;QAEnC,MAAM;QACN,MAAM;QAEN,MAAM;QAMN,MAAM;QAcD,MAAM;IAOX,8CAA8C;IAChD,GAAG;QAAC;QAAe;QAAiB;QAAqB;KAAI;IAE7D,SAAS,UAAU,GAAW;QAC5B,MAAM,YAAqC;YACzC,MAAM;YACN,mBAAmB;YACnB,aAAa;QACf;QACA,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE;QAErB,OAAO;QACP;;IAGF;IAEA,SAAS;QACP,IAAI,QAAQ,QAAQ;YAClB,IAAI,aAAa;gBACf,qBACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAG,WAAU;0CAAc;;;;;;;;;;;sCAE9B,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAO,KAAK;gCAAa,WAAU;;;;;;;;;;;;;;;;;YAI5C;YACA,IAAI,WAAW;gBACb,qBAAO,8OAAC,qIAAW;oBAAC,KAAK;;;;;;YAC3B;YACA,qBACE,8OAAC;gBAAI,WAAU;0BAAsG;;;;;;QAIzH;QAEA,IAAI,QAAQ,qBAAqB;YAC/B,IAAI,eAAe;gBACjB,qBACE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAG,WAAU;0CAAc;;;;;;;;;;;sCAE9B,8OAAC;4BAAI,WAAU;sCACb,cAAA,8OAAC;gCAAO,KAAK;gCAAe,WAAU;;;;;;;;;;;;;;;;;YAI9C;YACA,IAAI,sBAAsB;gBACxB,qBAAO,8OAAC,qIAAW;oBAAC,KAAK;;;;;;YAC3B;YACA,qBACE,8OAAC;gBAAI,WAAU;0BAAsG;;;;;;QAIzH;QAEA,cAAc;QACd,IAAI,iBAAiB;YACnB,qBAAO,8OAAC,qIAAW;gBAAC,KAAK;;;;;;QAC3B;QACA,qBACE,8OAAC;YAAI,WAAU;sBAAsG;;;;;;IAIzH;IAEA,MAAM,WAAW,CAAC,KAAa,UAC7B;YACE;YACA,UACI,QAAQ,MACN,wBACA,oCACF;SACL,CAAC,IAAI,CAAC;IAET,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,WAAW,SAAS,QAAQ;wBAC5B,SAAS,IAAM,UAAU;wBACzB,UAAU,CAAC;kCACZ;;;;;;kCAGD,8OAAC;wBACC,MAAK;wBACL,WAAW,SAAS,qBAAqB;wBACzC,SAAS,IAAM,UAAU;wBACzB,UAAU,CAAC;kCACZ;;;;;;kCAGD,8OAAC;wBACC,MAAK;wBACL,WAAW,SAAS,eAAe;wBACnC,SAAS,IAAM,UAAU;wBACzB,UAAU,CAAC;kCACZ;;;;;;;;;;;;0BAKH,8OAAC;gBAAI,WAAU;0BAAwB;;;;;;;;;;;;AAG7C","debugId":null}}]
}