{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/vedatcanduzgezen/Desktop/lumera-dental-website/portal/components/UploadButtons.tsx"],"sourcesContent":["// components/UploadButtons.tsx\n\"use client\";\n\nimport { useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\ntype Props = {\n  caseId: string;\n  label: \"SCAN\" | \"MODEL_PLUS_DESIGN\" | \"DESIGN_ONLY\";\n  accept: string;\n  title: string;\n  disabled?: boolean;\n};\n\nexport default function UploadButtons({\n  caseId,\n  label,\n  accept,\n  title,\n  disabled,\n}: Props) {\n  const [file, setFile] = useState<File | null>(null);\n  const [busy, setBusy] = useState(false);\n  const [msg, setMsg] = useState<string | null>(null);\n  const [err, setErr] = useState<string | null>(null);\n  const router = useRouter();\n\n  async function upload() {\n    setMsg(null);\n    setErr(null);\n    if (!file) return setErr(\"Choose a file first.\");\n    if (disabled) return setErr(\"This slot is locked at the current stage.\");\n\n    setBusy(true);\n    try {\n      const fd = new FormData();\n      fd.append(\"label\", label);\n      // best-effort kind based on extension\n      const ext = (file.name.split(\".\").pop() || \"\").toLowerCase();\n      const kind =\n        ext === \"stl\" ? \"STL\" : ext === \"ply\" ? \"PLY\" : ext === \"obj\" ? \"OBJ\" : \"OTHER\";\n      fd.append(\"kind\", kind);\n      fd.append(\"file\", file);\n\n      const res = await fetch(`/api/cases/${caseId}/files`, {\n        method: \"POST\",\n        body: fd,\n      });\n      const j = await res.json().catch(() => ({}));\n      if (!res.ok) throw new Error(j.error || \"Upload failed\");\n\n      setMsg(\"Saved.\");\n      setFile(null);\n      router.refresh();\n    } catch (e: any) {\n      setErr(e?.message || \"Upload failed\");\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  return (\n    <div className=\"rounded-xl border border-white/10 p-4\">\n      <h2 className=\"font-medium mb-2\">{title}</h2>\n      <div className=\"flex items-center gap-3\">\n        <input\n          type=\"file\"\n          accept={accept}\n          onChange={(e) => setFile(e.target.files?.[0] ?? null)}\n          className=\"text-sm\"\n          disabled={disabled}\n        />\n        <button\n          type=\"button\"\n          className=\"rounded-md bg-white text-black text-sm px-3 py-1.5 disabled:opacity-50\"\n          onClick={upload}\n          disabled={busy || disabled}\n        >\n          {busy ? \"Uploading…\" : \"Upload\"}\n        </button>\n      </div>\n      {disabled && (\n        <p className=\"text-xs text-white/50 mt-2\">\n          This slot can’t be changed at the current stage.\n        </p>\n      )}\n      {msg && <p className=\"text-emerald-400 text-sm mt-2\">{msg}</p>}\n      {err && <p className=\"text-red-400 text-sm mt-2\">{err}</p>}\n    </div>\n  );\n}\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;AAG/B;AACA;AAHA;;;;AAae,SAAS,cAAc,EACpC,MAAM,EACN,KAAK,EACL,MAAM,EACN,KAAK,EACL,QAAQ,EACF;IACN,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IACjC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAgB;IAC9C,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAgB;IAC9C,MAAM,SAAS,IAAA,+IAAS;IAExB,eAAe;QACb,OAAO;QACP,OAAO;QACP,IAAI,CAAC,MAAM,OAAO,OAAO;QACzB,IAAI,UAAU,OAAO,OAAO;QAE5B,QAAQ;QACR,IAAI;YACF,MAAM,KAAK,IAAI;YACf,GAAG,MAAM,CAAC,SAAS;YACnB,sCAAsC;YACtC,MAAM,MAAM,CAAC,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,MAAM,EAAE,EAAE,WAAW;YAC1D,MAAM,OACJ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ,QAAQ;YAC1E,GAAG,MAAM,CAAC,QAAQ;YAClB,GAAG,MAAM,CAAC,QAAQ;YAElB,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,OAAO,MAAM,CAAC,EAAE;gBACpD,QAAQ;gBACR,MAAM;YACR;YACA,MAAM,IAAI,MAAM,IAAI,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM,EAAE,KAAK,IAAI;YAExC,OAAO;YACP,QAAQ;YACR,OAAO,OAAO;QAChB,EAAE,OAAO,GAAQ;YACf,OAAO,GAAG,WAAW;QACvB,SAAU;YACR,QAAQ;QACV;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAAoB;;;;;;0BAClC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,QAAQ;wBACR,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,IAAI;wBAChD,WAAU;wBACV,UAAU;;;;;;kCAEZ,8OAAC;wBACC,MAAK;wBACL,WAAU;wBACV,SAAS;wBACT,UAAU,QAAQ;kCAEjB,OAAO,eAAe;;;;;;;;;;;;YAG1B,0BACC,8OAAC;gBAAE,WAAU;0BAA6B;;;;;;YAI3C,qBAAO,8OAAC;gBAAE,WAAU;0BAAiC;;;;;;YACrD,qBAAO,8OAAC;gBAAE,WAAU;0BAA6B;;;;;;;;;;;;AAGxD","debugId":null}}]
}